<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Main.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Main.cpp</h1><a href="Main_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00014 <span class="comment">//Basic Input/Output header:</span>
00015 <span class="preprocessor">#include &lt;iostream&gt;</span>
00016 
00017 <span class="comment">//Game headers:</span>
00018 <span class="preprocessor">#include "<a class="code" href="Main_8h.html">Main.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="Menu_8h.html">Menu.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="Gameplay_8h.html">Gameplay.h</a>"</span>
00021 
00022 <span class="comment">//Config parser header:</span>
00023 <span class="preprocessor">#include "<a class="code" href="ConfigParser_8h.html">ConfigParser.h</a>"</span>
00024 
00025 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a18">configure</a>();
00026 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a19">cleanUp</a>();
00027 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>();
00028 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a21">gameLoop</a>();
00029 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a22">outputConfiguration</a>();
00030 
00040 <span class="keywordtype">bool</span> <a class="code" href="Main_8cpp.html#a1">g_keys</a>[512];
00041 
00051 SDL_Surface *<a class="code" href="Main_8cpp.html#a2">g_screen</a> = 0;
00052 
00061 SDL_Surface *<a class="code" href="Main_8cpp.html#a3">g_gameBGR</a> = 0;
00062 
00071 SDL_Surface *<a class="code" href="Main_8cpp.html#a4">g_gameIcon</a> = 0;
00072 
00081 SDL_Surface *<a class="code" href="Main_8cpp.html#a5">g_advBar</a> = 0;
00082 
00091 <span class="keywordtype">long</span> <a class="code" href="Main_8cpp.html#a6">g_screenWidth</a>;
00092 
00101 <span class="keywordtype">long</span> <a class="code" href="Main_8cpp.html#a7">g_screenHeight</a>;
00102 
00112 <span class="keywordtype">bool</span> <a class="code" href="Main_8cpp.html#a8">g_inGame</a> = <span class="keyword">false</span>;
00113 
00123 <span class="keywordtype">bool</span> <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">false</span>;
00124 
00134 <span class="keywordtype">long</span> <a class="code" href="Main_8cpp.html#a10">g_players</a> = 1;
00135 
00145 <span class="keywordtype">bool</span> <a class="code" href="Main_8cpp.html#a11">drawError</a> = <span class="keyword">false</span>;
00146 
00157 <a class="code" href="classTetrisEngine.html">TetrisEngine</a> *<a class="code" href="Main_8cpp.html#a12">playerEngine1</a> = 0;
00158 
00169 <a class="code" href="classTetrisEngine.html">TetrisEngine</a> *<a class="code" href="Main_8cpp.html#a13">playerEngine2</a> = 0;
00170 
00180 <span class="keywordtype">bool</span> <a class="code" href="Main_8cpp.html#a14">g_soundEnabled</a> = <span class="keyword">true</span>;
00181 
00191 <span class="keywordtype">bool</span> <a class="code" href="Main_8cpp.html#a15">g_musicEnabled</a> = <span class="keyword">true</span>;
00192 
00202 <span class="keywordtype">long</span> <a class="code" href="Main_8cpp.html#a16">g_musicChannel</a> = 0;
00203 
00213 FSOUND_SAMPLE *<a class="code" href="Main_8cpp.html#a17">g_backgroundMusic</a> = 0;
00214 
00215 <span class="preprocessor">#ifdef _DEBUG</span>
00216 <span class="preprocessor"></span><span class="preprocessor">#define WRITEDEBUGMACRO() writeLog("This is a debug version of the game!\n");</span>
<a name="l00217"></a><a class="code" href="Main_8cpp.html#a0">00217</a> <span class="preprocessor"></span><span class="preprocessor">#else</span>
00218 <span class="preprocessor"></span><span class="preprocessor">#define WRITEDEBUGMACRO() ;</span>
00219 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00220 <span class="preprocessor"></span>
00221 <span class="preprocessor">#ifdef WIN32</span>
00222 <span class="preprocessor"></span><span class="preprocessor">#include "Windows.h"</span>
00223 
00224 <span class="keywordtype">int</span> WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, <span class="keywordtype">int</span> nShowCmd)
00225 {
00226 
00227         <a class="code" href="Main_8cpp.html#a23">main</a>(0, 0);
00228 
00229         <span class="keywordflow">return</span> 0;
00230 
00231 }
00232 
00233 <span class="preprocessor">#endif</span>
00234 <span class="preprocessor"></span>
00245 <span class="keywordtype">int</span> <a class="code" href="Main_8cpp.html#a23">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
00246 {
00247 
00248         <a class="code" href="namespaceLogFile.html#a3">setLogFile</a>(<span class="stringliteral">"../Output.txt"</span>);
00249 
00250         <a class="code" href="namespaceLogFile.html#a1">clearLog</a>();
00251 
00252         <a class="code" href="Main_8cpp.html#a18">configure</a>();
00253 
00254         <a class="code" href="Main_8cpp.html#a0">WRITEDEBUGMACRO</a>();
00255 
00256         <span class="comment">//Initilize SDL:</span>
00257         SDL_Init(SDL_INIT_VIDEO);
00258 
00259         <span class="comment">//Initilize FMod:</span>
00260         FSOUND_Init(44100, 32, 0);
00261 
00262         atexit(<a class="code" href="Main_8cpp.html#a19">cleanUp</a>);
00263 
00264         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a4">g_gameIcon</a>)
00265                 <a class="code" href="Main_8cpp.html#a4">g_gameIcon</a> = <a class="code" href="Util_8cpp.html#a0">loadImg</a>(<a class="code" href="Main_8h.html#a0">GFX_PATH</a>, <span class="stringliteral">"gameicon.png"</span>);
00266 
00267         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a4">g_gameIcon</a>)
00268         {
00269 
00270                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Loading of the game icon failed.\n"</span>);
00271 
00272                 <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
00273 
00274                 <span class="keywordflow">return</span> 0;
00275 
00276         }
00277 
00278         SDL_WM_SetIcon(<a class="code" href="Main_8cpp.html#a4">g_gameIcon</a>, 0);
00279 
00280         <a class="code" href="Main_8cpp.html#a6">g_screenWidth</a> = 800;
00281         <a class="code" href="Main_8cpp.html#a7">g_screenHeight</a> = 600;
00282 
00283         <span class="keywordflow">if</span>(SDL_VideoModeOK(<a class="code" href="Main_8cpp.html#a6">g_screenWidth</a>, <a class="code" href="Main_8cpp.html#a7">g_screenHeight</a>, 32, SDL_DOUBLEBUF | SDL_HWSURFACE | SDL_ANYFORMAT) == 0)
00284         {
00285 
00286                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Hardware rendering not supported, software rendering used.\n"</span>);
00287 
00288                 <a class="code" href="Main_8cpp.html#a2">g_screen</a> = SDL_SetVideoMode(<a class="code" href="Main_8cpp.html#a6">g_screenWidth</a>, <a class="code" href="Main_8cpp.html#a7">g_screenHeight</a>, 32, SDL_DOUBLEBUF | SDL_SWSURFACE | SDL_ANYFORMAT);
00289 
00290         } <span class="keywordflow">else</span> {
00291 
00292                 <a class="code" href="Main_8cpp.html#a2">g_screen</a> = SDL_SetVideoMode(<a class="code" href="Main_8cpp.html#a6">g_screenWidth</a>, <a class="code" href="Main_8cpp.html#a7">g_screenHeight</a>, 32, SDL_DOUBLEBUF | SDL_HWSURFACE | SDL_ANYFORMAT);
00293 
00294         }
00295 
00296         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a2">g_screen</a>)
00297         {
00298 
00299                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"SDL initiated unsuccessfully. \n"</span>);
00300 
00301                 <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>();
00302 
00303                 <span class="keywordflow">return</span> 0;
00304 
00305         }
00306 
00307         SDL_WM_SetCaption(<span class="stringliteral">"Swift blocks"</span>, 0);
00308 
00309         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a3">g_gameBGR</a>)
00310                 <a class="code" href="Main_8cpp.html#a3">g_gameBGR</a> = <a class="code" href="Util_8cpp.html#a0">loadImg</a>(<a class="code" href="Main_8h.html#a0">GFX_PATH</a>, <span class="stringliteral">"gamebgr.jpg"</span>);
00311 
00312         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a3">g_gameBGR</a>)
00313         {
00314 
00315                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Loading of the game background failed.\n"</span>);
00316 
00317                 <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
00318 
00319                 <span class="keywordflow">return</span> 0;
00320 
00321         }
00322 
00323         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a5">g_advBar</a>)
00324                 <a class="code" href="Main_8cpp.html#a5">g_advBar</a> = <a class="code" href="Util_8cpp.html#a0">loadImg</a>(<a class="code" href="Main_8h.html#a0">GFX_PATH</a>, <span class="stringliteral">"advbar.png"</span>);
00325 
00326         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a5">g_advBar</a>)
00327         {
00328 
00329                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Loading of the advantage bar failed.\n"</span>);
00330 
00331                 <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
00332 
00333                 <span class="keywordflow">return</span> 0;
00334 
00335         }
00336 
00337         <a class="code" href="Main_8cpp.html#a17">g_backgroundMusic</a> = <a class="code" href="Util_8cpp.html#a2">loadSound</a>(<a class="code" href="Main_8h.html#a1">SND_PATH</a>, <span class="stringliteral">"Music.ogg"</span>);
00338 
00339         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a17">g_backgroundMusic</a>)
00340         {
00341 
00342                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Loading of the background music failed.\n"</span>);
00343 
00344                 <a class="code" href="Menu_8cpp.html#a12">destroyMenu</a>();
00345 
00346                 <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>();
00347 
00348                 <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
00349 
00350                 <span class="keywordflow">return</span> 0;
00351 
00352         }
00353         
00354         <span class="keywordflow">if</span>(g_musicEnabled)
00355         {
00356         
00357                 FSOUND_SetLoopMode(<a class="code" href="Main_8cpp.html#a16">g_musicChannel</a> = FSOUND_PlaySound(FSOUND_FREE, <a class="code" href="Main_8cpp.html#a17">g_backgroundMusic</a>), FSOUND_LOOP_NORMAL);
00358 
00359         }
00360 
00361         <span class="keywordflow">if</span>(!<a class="code" href="Menu_8cpp.html#a9">loadMenu</a>())
00362         {
00363 
00364                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Loading of the menu failed.\n"</span>);
00365 
00366                 <a class="code" href="Menu_8cpp.html#a12">destroyMenu</a>();
00367 
00368                 <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>();
00369 
00370                 <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
00371 
00372                 <span class="keywordflow">return</span> 0;
00373 
00374         }
00375 
00376         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a> = <span class="keyword">new</span> <a class="code" href="classTetrisEngine.html">TetrisEngine</a>(420, 120);
00377         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a> = <span class="keyword">new</span> <a class="code" href="classTetrisEngine.html">TetrisEngine</a>(50, 120);
00378 
00379         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a26">setScreen</a>(<a class="code" href="Main_8cpp.html#a2">g_screen</a>);
00380         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a26">setScreen</a>(<a class="code" href="Main_8cpp.html#a2">g_screen</a>);
00381 
00382         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a23">setKeyConfig</a>(<a class="code" href="Gameplay_8h.html#a13a9">LeftKey</a>, SDLK_a);
00383         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a23">setKeyConfig</a>(<a class="code" href="Gameplay_8h.html#a13a10">RightKey</a>, SDLK_d);
00384         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a23">setKeyConfig</a>(<a class="code" href="Gameplay_8h.html#a13a8">RotateKey</a>, SDLK_w);
00385         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a23">setKeyConfig</a>(<a class="code" href="Gameplay_8h.html#a13a11">DownKey</a>, SDLK_s);
00386 
00387         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a21">setCountScore</a>(<span class="keyword">true</span>);
00388         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a21">setCountScore</a>(<span class="keyword">true</span>);
00389 
00390         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a27">setSoundEnabled</a>(<a class="code" href="Main_8cpp.html#a14">g_soundEnabled</a>);
00391         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a27">setSoundEnabled</a>(<a class="code" href="Main_8cpp.html#a14">g_soundEnabled</a>);
00392 
00393         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a19">loadGame</a>())
00394         {
00395 
00396                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Loading of the game failed.\n"</span>);
00397 
00398                 <a class="code" href="Menu_8cpp.html#a12">destroyMenu</a>();
00399 
00400                 <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>();
00401 
00402                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a5">destroyGame</a>();
00403 
00404                 <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
00405 
00406                 <span class="keywordflow">return</span> 0;
00407 
00408         }
00409 
00410         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a19">loadGame</a>())
00411         {
00412 
00413                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Loading of the game failed.\n"</span>);
00414 
00415                 <a class="code" href="Menu_8cpp.html#a12">destroyMenu</a>();
00416 
00417                 <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>();
00418 
00419                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a5">destroyGame</a>();
00420 
00421                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a5">destroyGame</a>();
00422 
00423                 <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
00424 
00425                 <span class="keywordflow">return</span> 0;
00426 
00427         }
00428 
00429         <span class="keywordflow">while</span>(!<a class="code" href="Main_8cpp.html#a9">g_quitGame</a>)
00430         {
00431 
00432                 <span class="keywordflow">while</span>(!<a class="code" href="Main_8cpp.html#a8">g_inGame</a> &amp;&amp; !<a class="code" href="Main_8cpp.html#a9">g_quitGame</a>)
00433                 {
00434                 
00435                         <a class="code" href="Menu_8cpp.html#a11">menuLoop</a>();
00436 
00437                 }
00438 
00439                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a20">resetGame</a>();
00440                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a20">resetGame</a>();
00441 
00442                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a27">setSoundEnabled</a>(<a class="code" href="Main_8cpp.html#a14">g_soundEnabled</a>);
00443                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a27">setSoundEnabled</a>(<a class="code" href="Main_8cpp.html#a14">g_soundEnabled</a>);
00444 
00445                 <span class="keywordflow">if</span>(SDL_BlitSurface(<a class="code" href="Main_8cpp.html#a3">g_gameBGR</a>, 0, <a class="code" href="Main_8cpp.html#a2">g_screen</a>, 0) &lt; 0)
00446                 {
00447         
00448                         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a11">drawError</a>)
00449                         {
00450 
00451                                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Failed to draw game background.\n"</span>);
00452 
00453                         }
00454 
00455                         <a class="code" href="Main_8cpp.html#a11">drawError</a> = <span class="keyword">true</span>;
00456 
00457                 }
00458 
00459                 <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> == 1)
00460                 {
00461 
00462                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a29">setX</a>(250);
00463                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a30">setY</a>(120);
00464                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a29">setX</a>(50);
00465                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a30">setY</a>(120);
00466 
00467                 } 
00468                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> == 2)
00469                 {
00470 
00471                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a29">setX</a>(420);
00472                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a30">setY</a>(120);
00473                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a29">setX</a>(50);
00474                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a30">setY</a>(120);
00475 
00476                 }
00477 
00478                 <span class="keywordflow">while</span>(<a class="code" href="Main_8cpp.html#a8">g_inGame</a> &amp;&amp; !<a class="code" href="Main_8cpp.html#a9">g_quitGame</a>)
00479                 {
00480 
00481                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> == 2)
00482                         {
00483 
00484                                 SDL_Rect rect;
00485                                 <span class="keywordtype">long</span> stepSize = 0;
00486 
00487                                 rect.x = 170;
00488                                 rect.y = 500;
00489 
00490                                 <span class="keywordflow">if</span>(SDL_BlitSurface(<a class="code" href="Main_8cpp.html#a5">g_advBar</a>, 0, <a class="code" href="Main_8cpp.html#a2">g_screen</a>, &amp;rect) &lt; 0)
00491                                 {
00492         
00493                                         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a11">drawError</a>)
00494                                         {
00495 
00496                                                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Failed to draw advantage bar.\n"</span>);
00497 
00498                                         }
00499 
00500                                         <a class="code" href="Main_8cpp.html#a11">drawError</a> = <span class="keyword">true</span>;
00501 
00502                                 }
00503 
00504                                 <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a12">getLevel</a>() != 0 || <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a12">getLevel</a>() != 0)
00505                                 {
00506 
00507                                         stepSize = (<a class="code" href="Main_8cpp.html#a5">g_advBar</a>-&gt;w - 10) / 14;
00508                                         
00509                                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a12">getLevel</a>() != 0)
00510                                         {
00511 
00512                                                 rect.x = 170 + 6 + (<a class="code" href="Main_8cpp.html#a5">g_advBar</a>-&gt;w - 12) * 0.5;
00513                                                 rect.y = 500 + 6;
00514 
00515                                                 rect.w = stepSize * <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a12">getLevel</a>();
00516 
00517                                         } <span class="keywordflow">else</span> {
00518 
00519                                                 rect.x = 170 + 6 + ((<a class="code" href="Main_8cpp.html#a5">g_advBar</a>-&gt;w - 12) * 0.5) - (stepSize * <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a12">getLevel</a>());
00520                                                 rect.y = 500 + 6;
00521 
00522                                                 rect.w = stepSize * <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a12">getLevel</a>();
00523 
00524                                         }
00525 
00526                                         rect.h = <a class="code" href="Main_8cpp.html#a5">g_advBar</a>-&gt;h - 12;
00527 
00528                                         SDL_FillRect(<a class="code" href="Main_8cpp.html#a2">g_screen</a>, &amp;rect, 0x000090);
00529 
00530                                 }
00531 
00532                                 rect.x = 170 + 6 + ((<a class="code" href="Main_8cpp.html#a5">g_advBar</a>-&gt;w - 12) * 0.5);
00533                                 rect.y = 500 + 6;
00534                                 rect.h = <a class="code" href="Main_8cpp.html#a5">g_advBar</a>-&gt;h - 12;
00535                                 rect.w = 1;
00536 
00537                                 SDL_FillRect(<a class="code" href="Main_8cpp.html#a2">g_screen</a>, &amp;rect, 0xFFFFFF);
00538 
00539                         }
00540 
00541                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> == 1)
00542                         {
00543 
00544                                 <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; 10)
00545                                 {
00546 
00547                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(1);
00548 
00549                                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; 20)
00550                                         {
00551 
00552                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(2);
00553 
00554                                         }
00555 
00556                                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; 40)
00557                                         {
00558 
00559                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(3);
00560 
00561                                         }
00562 
00563                                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; 60)
00564                                         {
00565 
00566                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(4);
00567 
00568                                         }
00569 
00570                                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; 80)
00571                                         {
00572 
00573                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(5);
00574 
00575                                         }
00576 
00577                                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; 110)
00578                                         {
00579 
00580                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(6);
00581 
00582                                         }
00583 
00584                                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; 140)
00585                                         {
00586 
00587                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(7);
00588 
00589                                         }
00590 
00591                                         <span class="keywordtype">char</span> path[255];
00592 
00593                                         sprintf(path, <span class="stringliteral">"%sgamefield%d.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>, <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a12">getLevel</a>() + 1);
00594 
00595                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00596 
00597                                 }
00598 
00599                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> == 2) {
00600 
00601                                 <span class="keywordtype">long</span> erased = 0;
00602 
00603                                 erased = <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>();
00604 
00605                                 <span class="keywordflow">if</span>(erased &gt; 10 &amp;&amp; erased &lt; 21)
00606                                 {
00607 
00608                                         <span class="keywordtype">char</span> path[255];
00609 
00610                                         sprintf(path, <span class="stringliteral">"%sgamefield2.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00611 
00612                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00613 
00614                                 }
00615 
00616                                 <span class="keywordflow">if</span>(erased &gt; 20 &amp;&amp; erased &lt; 41)
00617                                 {
00618 
00619                                         <span class="keywordtype">char</span> path[255];
00620 
00621                                         sprintf(path, <span class="stringliteral">"%sgamefield3.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00622 
00623                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00624 
00625                                 }
00626 
00627                                 <span class="keywordflow">if</span>(erased &gt; 40 &amp;&amp; erased &lt; 61)
00628                                 {
00629 
00630                                         <span class="keywordtype">char</span> path[255];
00631 
00632                                         sprintf(path, <span class="stringliteral">"%sgamefield4.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00633 
00634                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00635 
00636                                 }
00637 
00638                                 <span class="keywordflow">if</span>(erased &gt; 60 &amp;&amp; erased &lt; 81)
00639                                 {
00640 
00641                                         <span class="keywordtype">char</span> path[255];
00642 
00643                                         sprintf(path, <span class="stringliteral">"%sgamefield5.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00644 
00645                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00646 
00647                                 }
00648 
00649                                 <span class="keywordflow">if</span>(erased &gt; 80 &amp;&amp; erased &lt; 111)
00650                                 {
00651 
00652                                         <span class="keywordtype">char</span> path[255];
00653 
00654                                         sprintf(path, <span class="stringliteral">"%sgamefield6.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00655 
00656                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00657 
00658                                 }
00659 
00660                                 <span class="keywordflow">if</span>(erased &gt; 110 &amp;&amp; erased &lt; 141)
00661                                 {
00662 
00663                                         <span class="keywordtype">char</span> path[255];
00664 
00665                                         sprintf(path, <span class="stringliteral">"%sgamefield7.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00666 
00667                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00668 
00669                                 }
00670 
00671                                 <span class="keywordflow">if</span>(erased &gt; 140)
00672                                 {
00673 
00674                                         <span class="keywordtype">char</span> path[255];
00675 
00676                                         sprintf(path, <span class="stringliteral">"%sgamefield8.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00677 
00678                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00679 
00680                                 }
00681 
00682                                 erased = <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>();
00683 
00684                                 <span class="keywordflow">if</span>(erased &gt; 10 &amp;&amp; erased &lt; 21)
00685                                 {
00686 
00687                                         <span class="keywordtype">char</span> path[255];
00688 
00689                                         sprintf(path, <span class="stringliteral">"%sgamefield2.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00690 
00691                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00692 
00693                                 }
00694 
00695                                 <span class="keywordflow">if</span>(erased &gt; 20 &amp;&amp; erased &lt; 41)
00696                                 {
00697 
00698                                         <span class="keywordtype">char</span> path[255];
00699 
00700                                         sprintf(path, <span class="stringliteral">"%sgamefield3.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00701 
00702                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00703 
00704                                 }
00705 
00706                                 <span class="keywordflow">if</span>(erased &gt; 40 &amp;&amp; erased &lt; 61)
00707                                 {
00708 
00709                                         <span class="keywordtype">char</span> path[255];
00710 
00711                                         sprintf(path, <span class="stringliteral">"%sgamefield4.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00712 
00713                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00714 
00715                                 }
00716 
00717                                 <span class="keywordflow">if</span>(erased &gt; 60 &amp;&amp; erased &lt; 81)
00718                                 {
00719 
00720                                         <span class="keywordtype">char</span> path[255];
00721 
00722                                         sprintf(path, <span class="stringliteral">"%sgamefield5.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00723 
00724                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00725 
00726                                 }
00727 
00728                                 <span class="keywordflow">if</span>(erased &gt; 80 &amp;&amp; erased &lt; 111)
00729                                 {
00730 
00731                                         <span class="keywordtype">char</span> path[255];
00732 
00733                                         sprintf(path, <span class="stringliteral">"%sgamefield6.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00734 
00735                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00736 
00737                                 }
00738 
00739                                 <span class="keywordflow">if</span>(erased &gt; 110 &amp;&amp; erased &lt; 141)
00740                                 {
00741 
00742                                         <span class="keywordtype">char</span> path[255];
00743 
00744                                         sprintf(path, <span class="stringliteral">"%sgamefield7.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00745 
00746                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00747 
00748                                 }
00749 
00750                                 <span class="keywordflow">if</span>(erased &gt; 140)
00751                                 {
00752 
00753                                         <span class="keywordtype">char</span> path[255];
00754 
00755                                         sprintf(path, <span class="stringliteral">"%sgamefield8.jpg"</span>, <a class="code" href="Main_8h.html#a0">GFX_PATH</a>);
00756 
00757                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a4">changeBGR</a>(path);
00758 
00759                                 }                               
00760 
00761                                 <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() == <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>())
00762                                 {
00763                                 
00764                                         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00765                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00766 
00767                                 }
00768                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() &gt; <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>())
00769                                 {
00770 
00771                                         <span class="keywordtype">long</span> delta = (<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() - <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>());
00772 
00773                                         <span class="keywordflow">if</span>(delta &lt; 2)
00774                                         {
00775 
00776                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00777                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00778 
00779                                         }
00780 
00781                                         <span class="keywordflow">if</span>(delta &gt;= 2)
00782                                         {
00783 
00784                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00785                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(1);
00786 
00787                                         }
00788 
00789                                         <span class="keywordflow">if</span>(delta &gt;= 4)
00790                                         {
00791 
00792                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00793                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(2);
00794 
00795                                         }
00796 
00797                                         <span class="keywordflow">if</span>(delta &gt;= 6)
00798                                         {
00799 
00800                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00801                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(3);
00802 
00803                                         }
00804 
00805                                         <span class="keywordflow">if</span>(delta &gt;= 8)
00806                                         {
00807 
00808                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00809                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(4);
00810 
00811                                         }
00812 
00813                                         <span class="keywordflow">if</span>(delta &gt;= 10)
00814                                         {
00815 
00816                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00817                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(5);
00818 
00819                                         }
00820 
00821                                         <span class="keywordflow">if</span>(delta &gt;= 12)
00822                                         {
00823 
00824                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00825                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(6);
00826 
00827                                         }
00828 
00829                                         <span class="keywordflow">if</span>(delta &gt;= 14)
00830                                         {
00831 
00832                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00833                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(7);
00834 
00835                                         }
00836 
00837                                 }
00838                                 <span class="keywordflow">else</span>
00839                                 {
00840 
00841                                         <span class="keywordtype">long</span> delta = (<a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>() - <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a13">getLinesErased</a>());
00842 
00843                                         <span class="keywordflow">if</span>(delta &lt; 2)
00844                                         {
00845 
00846                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00847                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00848 
00849                                         }
00850 
00851                                         <span class="keywordflow">if</span>(delta &gt;= 2)
00852                                         {
00853 
00854                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00855                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(1);
00856 
00857                                         }
00858 
00859                                         <span class="keywordflow">if</span>(delta &gt;= 4)
00860                                         {
00861 
00862                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00863                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(2);
00864 
00865                                         }
00866 
00867                                         <span class="keywordflow">if</span>(delta &gt;= 6)
00868                                         {
00869 
00870                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00871                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(3);
00872 
00873                                         }
00874 
00875                                         <span class="keywordflow">if</span>(delta &gt;= 8)
00876                                         {
00877 
00878                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00879                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(4);
00880 
00881                                         }
00882 
00883                                         <span class="keywordflow">if</span>(delta &gt;= 10)
00884                                         {
00885 
00886                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00887                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(5);
00888 
00889                                         }
00890 
00891                                         <span class="keywordflow">if</span>(delta &gt;= 12)
00892                                         {
00893 
00894                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00895                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(6);
00896 
00897                                         }
00898 
00899                                         <span class="keywordflow">if</span>(delta &gt;= 14)
00900                                         {
00901 
00902                                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(0);
00903                                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a24">setLevel</a>(7);
00904 
00905                                         }
00906 
00907                                 }
00908 
00909                         }
00910 
00911                         <a class="code" href="Main_8cpp.html#a21">gameLoop</a>();
00912 
00913                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a10">getGameOver</a>())
00914                         {
00915 
00916                                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a28">setWinner</a>(<span class="keyword">true</span>);
00917 
00918                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a10">getGameOver</a>())
00919                         {
00920 
00921                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a28">setWinner</a>(<span class="keyword">true</span>);
00922 
00923                         }
00924 
00925                 }
00926 
00927         }
00928 
00929         <a class="code" href="Menu_8cpp.html#a12">destroyMenu</a>();
00930 
00931         <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>();
00932 
00933         <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a5">destroyGame</a>();
00934         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a5">destroyGame</a>();
00935 
00936         <span class="keywordflow">if</span>(playerEngine1)
00937         {
00938                 
00939                 <span class="keyword">delete</span> <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>;
00940 
00941                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a> = 0;
00942 
00943         }
00944 
00945         <span class="keywordflow">if</span>(playerEngine2)
00946         {
00947                 
00948                 <span class="keyword">delete</span> <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>;
00949 
00950                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a> = 0;
00951 
00952         }
00953 
00954         <span class="keywordflow">return</span> 0;
00955 
00956 }
00957 
00967 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a18">configure</a>()
00968 {
00969 
00970         <a class="code" href="classConfigParser.html">ConfigParser</a> p;
00971 
00972         <span class="keywordflow">if</span>(!p.<a class="code" href="classConfigParser.html#a2">loadFile</a>(<span class="stringliteral">"../Config.cfg"</span>))
00973         {
00974 
00975                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"No configuration file present.\n"</span>);
00976 
00977                 <span class="keywordflow">return</span>;
00978 
00979         }
00980 
00981         <span class="keywordflow">if</span>(p.<a class="code" href="classConfigParser.html#a4">readLong</a>(<span class="stringliteral">"sound"</span>, 0) == 1)
00982         {
00983 
00984                 <a class="code" href="Main_8cpp.html#a14">g_soundEnabled</a> = <span class="keyword">true</span>;
00985 
00986         } <span class="keywordflow">else</span> {
00987 
00988                 <a class="code" href="Main_8cpp.html#a14">g_soundEnabled</a> = <span class="keyword">false</span>;
00989 
00990         }
00991 
00992         <span class="keywordflow">if</span>(p.<a class="code" href="classConfigParser.html#a4">readLong</a>(<span class="stringliteral">"music"</span>, 0) == 1)
00993         {
00994 
00995                 <a class="code" href="Main_8cpp.html#a15">g_musicEnabled</a> = <span class="keyword">true</span>;
00996 
00997         } <span class="keywordflow">else</span> {
00998 
00999                 <a class="code" href="Main_8cpp.html#a15">g_musicEnabled</a> = <span class="keyword">false</span>;
01000 
01001         }
01002 
01003 }
01004 
01014 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a19">cleanUp</a>()
01015 {
01016 
01017         <span class="keywordflow">if</span>(playerEngine1)
01018         {
01019                 
01020                 <span class="keyword">delete</span> <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>;
01021 
01022                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a> = 0;
01023 
01024         }
01025 
01026         <span class="keywordflow">if</span>(playerEngine2)
01027         {
01028                 
01029                 <span class="keyword">delete</span> <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>;
01030 
01031                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a> = 0;
01032 
01033         }
01034 
01035         <span class="keywordflow">if</span>(g_backgroundMusic)
01036         {
01037                 
01038                 FSOUND_Sample_Free(<a class="code" href="Main_8cpp.html#a17">g_backgroundMusic</a>);
01039                 
01040                 <a class="code" href="Main_8cpp.html#a17">g_backgroundMusic</a> = 0;
01041 
01042         }
01043 
01044         
01045         SDL_Quit();
01046 
01047 }
01048 
01058 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a21">gameLoop</a>()
01059 {
01060 
01061         SDL_Event e;
01062         
01063         <span class="keywordflow">while</span>(SDL_PollEvent(&amp;e)) {
01064         
01065                 <span class="keywordflow">if</span>(e.type == SDL_QUIT)
01066                 {
01067 
01068                         <a class="code" href="Main_8cpp.html#a8">g_inGame</a> = <span class="keyword">false</span>;
01069                         
01070                         <a class="code" href="Main_8cpp.html#a9">g_quitGame</a> = <span class="keyword">true</span>;
01071 
01072                         <span class="keywordflow">return</span>;
01073 
01074                 }
01075 
01076                 <span class="keywordflow">if</span>(e.type == SDL_KEYDOWN)
01077                 {
01078 
01079                         <span class="keywordflow">if</span>(e.key.keysym.sym == SDLK_ESCAPE)
01080                         {
01081 
01082                                 <a class="code" href="Main_8cpp.html#a8">g_inGame</a> = <span class="keyword">false</span>;
01083 
01084                         }
01085 
01086                         <a class="code" href="Main_8cpp.html#a1">g_keys</a>[e.key.keysym.sym] = <span class="keyword">true</span>;
01087 
01088                         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a1">g_keys</a>[SDLK_p])
01089                         {
01090 
01091                                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a25">setPauseState</a>(!<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a14">getPauseState</a>());
01092 
01093                                 <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> &gt; 1)
01094                                 {
01095 
01096                                         <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a25">setPauseState</a>(!<a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a14">getPauseState</a>());
01097                                         
01098 
01099                                 }
01100 
01101                                 <a class="code" href="Main_8cpp.html#a1">g_keys</a>[SDLK_g] = <span class="keyword">false</span>;
01102 
01103                         }
01104 
01105                 }
01106 
01107                 <span class="keywordflow">if</span>(e.type == SDL_KEYUP)
01108                 {
01109 
01110                         <a class="code" href="Main_8cpp.html#a1">g_keys</a>[e.key.keysym.sym] = <span class="keyword">false</span>;
01111 
01112                 }
01113                 
01114         };
01115 
01116         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> &gt; 0)
01117                 <a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a31">updateGame</a>();
01118         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> &gt; 1)
01119                 <a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a31">updateGame</a>();
01120 
01121         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> &gt; 0)
01122         {
01123 
01124                 <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a12">playerEngine1</a>-&gt;<a class="code" href="classTetrisEngine.html#a6">drawGame</a>())
01125                 {
01126 
01127                         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a11">drawError</a>)
01128                         {
01129 
01130                                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Failed to draw game.\n"</span>);
01131 
01132                         }
01133 
01134                         <a class="code" href="Main_8cpp.html#a11">drawError</a> = <span class="keyword">true</span>;
01135 
01136                 }
01137 
01138         }
01139 
01140         <span class="keywordflow">if</span>(<a class="code" href="Main_8cpp.html#a10">g_players</a> &gt; 1)
01141         {
01142 
01143                 <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a13">playerEngine2</a>-&gt;<a class="code" href="classTetrisEngine.html#a6">drawGame</a>())
01144                 {
01145 
01146                         <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a11">drawError</a>)
01147                         {
01148 
01149                                 <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Failed to draw game.\n"</span>);
01150 
01151                         }
01152 
01153                         <a class="code" href="Main_8cpp.html#a11">drawError</a> = <span class="keyword">true</span>;
01154 
01155                 }
01156 
01157         }
01158 
01159         <span class="keywordflow">if</span>(SDL_Flip(<a class="code" href="Main_8cpp.html#a2">g_screen</a>) &lt; 0)
01160         {
01161                 
01162                 <span class="keywordflow">if</span>(!<a class="code" href="Main_8cpp.html#a11">drawError</a>)
01163                 {
01164 
01165                         <a class="code" href="namespaceLogFile.html#a4">writeLog</a>(<span class="stringliteral">"Failed to flip buffers.\n"</span>);
01166 
01167                 }
01168 
01169                 <a class="code" href="Main_8cpp.html#a11">drawError</a> = <span class="keyword">true</span>;
01170 
01171         }
01172 
01173 
01174 }
01175 
01186 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a20">freeSurfaces</a>()
01187 {
01188 
01189         <span class="keywordflow">if</span>(g_gameIcon)
01190         {
01191 
01192                 SDL_FreeSurface(<a class="code" href="Main_8cpp.html#a4">g_gameIcon</a>);
01193 
01194                 <a class="code" href="Main_8cpp.html#a4">g_gameIcon</a> = 0;
01195 
01196         }
01197 
01198         <span class="keywordflow">if</span>(g_gameBGR)
01199         {
01200 
01201                 SDL_FreeSurface(<a class="code" href="Main_8cpp.html#a3">g_gameBGR</a>);
01202 
01203                 <a class="code" href="Main_8cpp.html#a3">g_gameBGR</a> = 0;
01204 
01205         }
01206 
01207         <span class="keywordflow">if</span>(g_advBar)
01208         {
01209 
01210                 SDL_FreeSurface(<a class="code" href="Main_8cpp.html#a5">g_advBar</a>);
01211 
01212                 <a class="code" href="Main_8cpp.html#a5">g_advBar</a> = 0;
01213 
01214         }
01215 
01216 }
<a name="l01217"></a><a class="code" href="Main_8cpp.html#a22">01217</a> 
01218 <span class="keywordtype">void</span> <a class="code" href="Main_8cpp.html#a22">outputConfiguration</a>()
01219 {
01220 
01221         FILE *f = fopen(<span class="stringliteral">"../Config.cfg"</span>, <span class="stringliteral">"w"</span>);
01222 
01223         <span class="keywordflow">if</span>(!f)
01224                 <span class="keywordflow">return</span>;
01225 
01226         fprintf(f, <span class="stringliteral">"#Config file for Swift blocks.\n\n"</span>);
01227         fprintf(f, <span class="stringliteral">"#Sound status (1 = on, 0 = off):\n"</span>);
01228         
01229         <span class="keywordflow">if</span>(g_soundEnabled)
01230         {
01231 
01232                 fprintf(f, <span class="stringliteral">"Sound = 1;\n\n"</span>);
01233 
01234         } <span class="keywordflow">else</span> {
01235 
01236                 fprintf(f, <span class="stringliteral">"Sound = 0;\n\n"</span>);
01237 
01238         }
01239 
01240         fprintf(f, <span class="stringliteral">"#Music status (1 = on, 0 = off):\n"</span>);
01241         
01242         <span class="keywordflow">if</span>(g_musicEnabled)
01243         {
01244 
01245                 fprintf(f, <span class="stringliteral">"Music = 1;"</span>);
01246 
01247         } <span class="keywordflow">else</span> {
01248 
01249                 fprintf(f, <span class="stringliteral">"Music = 0;"</span>);
01250 
01251         }
01252 
01253 }
</pre></div><hr><address style="align: right;"><small>Generated on Wed Jan 8 19:41:41 2003 for Swift blocks by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc1 </small></address>
</body>
</html>
